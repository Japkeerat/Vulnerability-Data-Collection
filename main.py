import time
import logging
import multiprocessing

from nvd_data_extractor import NVDDataExtractor


def extract_data(transformation_queue):
    extractor = NVDDataExtractor(transformation_queue)
    extractor.extract_data()


def transform_data(transformation_queue, loading_queue):
    pass


def load_data(loading_queue):
    pass


def main():
    transformation_queue = multiprocessing.Queue()
    loading_queue = multiprocessing.Queue()
    
    extraction_process = multiprocessing.Process(target=extract_data, args=(transformation_queue,))
    transformation_process = multiprocessing.Process(target=transform_data, args=(transformation_queue, loading_queue))
    loading_process = multiprocessing.Process(target=load_data, args=(loading_queue,))
    
    extraction_process.start()
    transformation_process.start()
    loading_process.start()
    
    extraction_process.join()
    transformation_process.join()
    loading_process.join()


if __name__ == "__main__":
    logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s", datefmt="%d-%b-%y %H:%M:%S", filename="execution.log", filemode="w")
    main()
